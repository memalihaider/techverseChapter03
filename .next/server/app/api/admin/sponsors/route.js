"use strict";(()=>{var e={};e.id=8081,e.ids=[8081],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},2959:(e,r,s)=>{s.r(r),s.d(r,{originalPathname:()=>x,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var o={};s.r(o),s.d(o,{GET:()=>p,POST:()=>c});var t=s(49303),n=s(88716),a=s(60670),i=s(87070),u=s(3360);async function p(e){try{if(!e.cookies.get("admin_session")?.value)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r,error:s}=await u.pR.from("sponsors").select("*").order("tier_order",{ascending:!0}).order("display_order",{ascending:!0});if(s)return console.error("Error fetching sponsors:",s),i.NextResponse.json({error:"Failed to fetch sponsors"},{status:500});return i.NextResponse.json({success:!0,sponsors:r||[]})}catch(e){return console.error("Sponsors fetch error:",e),i.NextResponse.json({error:"An error occurred"},{status:500})}}async function c(e){try{let r=e.cookies.get("admin_session")?.value;if(!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=JSON.parse(Buffer.from(r,"base64").toString()),{name:o,logo_emoji:t,description:n,website:a,tier:p,is_active:c}=await e.json();if(!o||!n||!a||!p)return i.NextResponse.json({error:"Missing required fields"},{status:400});let{data:l,error:d}=await u.pR.from("sponsors").insert({name:o,logo_emoji:t||"\uD83C\uDFE2",description:n,website:a,tier:p,tier_order:{Platinum:1,Gold:2,Silver:3,Bronze:4}[p]||3,is_active:void 0===c||c,created_by:s.id,social_links:{}}).select().single();if(d)return console.error("Error creating sponsor:",d),i.NextResponse.json({error:"Failed to create sponsor"},{status:500});return await (0,u.ag)(s.id,"CREATE","sponsors",l.id,null,l),i.NextResponse.json({success:!0,sponsor:l})}catch(e){return console.error("Create sponsor error:",e),i.NextResponse.json({error:"An error occurred"},{status:500})}}let l=new t.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/sponsors/route",pathname:"/api/admin/sponsors",filename:"route",bundlePath:"app/api/admin/sponsors/route"},resolvedPagePath:"/Users/macbookpro/Personal Work/tecverse03/app/api/admin/sponsors/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:f}=l,x="/api/admin/sponsors/route";function g(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},3360:(e,r,s)=>{s.d(r,{ag:()=>p,pR:()=>a,v9:()=>u});var o=s(43974),t=s(42023);let n=process.env.SUPABASE_SERVICE_ROLE_KEY,a=(0,o.eI)("https://xplcgqfweqzliiwchmqw.supabase.co",n);async function i(e,r){return t.compare(e,r)}async function u(e,r){try{let{data:s,error:o}=await a.from("admin_users").select("*").eq("email",e).eq("is_active",!0).single();if(o||!s||!await i(r,s.password_hash))return null;await a.from("admin_users").update({last_login:new Date().toISOString()}).eq("id",s.id);let{password_hash:t,...n}=s;return n}catch(e){return console.error("Authentication error:",e),null}}async function p(e,r,s,o=null,t=null,n=null){try{await a.from("activity_logs").insert({admin_id:e,action:r,table_name:s,record_id:o,old_values:t,new_values:n})}catch(e){console.error("Activity log error:",e)}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),o=r.X(0,[8948,5972,3974,2023],()=>s(2959));module.exports=o})();