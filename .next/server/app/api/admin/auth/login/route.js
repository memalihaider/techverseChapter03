"use strict";(()=>{var e={};e.id=7840,e.ids=[7840],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},72928:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var a={};t.r(a),t.d(a,{POST:()=>l});var i=t(49303),o=t(88716),n=t(60670),s=t(87070),u=t(3360);async function l(e){try{let{email:r,password:t}=await e.json();if(!r||!t)return s.NextResponse.json({error:"Email and password are required"},{status:400});let a=await (0,u.v9)(r,t);if(!a)return s.NextResponse.json({error:"Invalid credentials"},{status:401});let i=Buffer.from(JSON.stringify({id:a.id,email:a.email,role:a.role,timestamp:Date.now()})).toString("base64"),o=s.NextResponse.json({success:!0,admin:{id:a.id,email:a.email,full_name:a.full_name,role:a.role,permissions:a.permissions}});return o.cookies.set("admin_session",i,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),o}catch(e){return console.error("Login error:",e),s.NextResponse.json({error:"An error occurred during login"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/auth/login/route",pathname:"/api/admin/auth/login",filename:"route",bundlePath:"app/api/admin/auth/login/route"},resolvedPagePath:"/Users/macbookpro/Personal Work/tecverse03/app/api/admin/auth/login/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m}=p,g="/api/admin/auth/login/route";function h(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},3360:(e,r,t)=>{t.d(r,{ag:()=>l,pR:()=>n,v9:()=>u});var a=t(43974),i=t(42023);let o=process.env.SUPABASE_SERVICE_ROLE_KEY,n=(0,a.eI)("https://xplcgqfweqzliiwchmqw.supabase.co",o);async function s(e,r){return i.compare(e,r)}async function u(e,r){try{let{data:t,error:a}=await n.from("admin_users").select("*").eq("email",e).eq("is_active",!0).single();if(a||!t||!await s(r,t.password_hash))return null;await n.from("admin_users").update({last_login:new Date().toISOString()}).eq("id",t.id);let{password_hash:i,...o}=t;return o}catch(e){return console.error("Authentication error:",e),null}}async function l(e,r,t,a=null,i=null,o=null){try{await n.from("activity_logs").insert({admin_id:e,action:r,table_name:t,record_id:a,old_values:i,new_values:o})}catch(e){console.error("Activity log error:",e)}}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948,5972,3974,2023],()=>t(72928));module.exports=a})();