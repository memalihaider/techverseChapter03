"use strict";(()=>{var e={};e.id=819,e.ids=[819],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},82432:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>h,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>c});var i=t(49303),o=t(88716),n=t(60670),a=t(87070),u=t(3360);async function l(e){try{if(!e.cookies.get("admin_session")?.value)return a.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r,error:t}=await u.pR.from("event_highlights").select("*").order("is_featured",{ascending:!1}).order("event_year",{ascending:!1}).order("display_order",{ascending:!0});if(t)return console.error("Error fetching highlights:",t),a.NextResponse.json({error:"Failed to fetch highlights"},{status:500});return a.NextResponse.json({success:!0,highlights:r||[]})}catch(e){return console.error("Highlights fetch error:",e),a.NextResponse.json({error:"An error occurred"},{status:500})}}async function c(e){try{let r=e.cookies.get("admin_session")?.value;if(!r)return a.NextResponse.json({error:"Unauthorized"},{status:401});let t=JSON.parse(Buffer.from(r,"base64").toString()),{title:s,description:i,media_type:o,media_url:n,thumbnail_url:l,event_year:c,category:h,is_active:d,is_featured:p}=await e.json();if(!s||!o||!n)return a.NextResponse.json({error:"Missing required fields"},{status:400});let{data:g,error:m}=await u.pR.from("event_highlights").insert({title:s,description:i||null,media_type:o,media_url:n,thumbnail_url:l||null,event_year:c||null,category:h||null,is_active:void 0===d||d,is_featured:p||!1,uploaded_by:t.id}).select().single();if(m)return console.error("Error creating highlight:",m),a.NextResponse.json({error:"Failed to create highlight"},{status:500});return await (0,u.ag)(t.id,"CREATE","event_highlights",g.id,null,g),a.NextResponse.json({success:!0,highlight:g})}catch(e){return console.error("Create highlight error:",e),a.NextResponse.json({error:"An error occurred"},{status:500})}}let h=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/highlights/route",pathname:"/api/admin/highlights",filename:"route",bundlePath:"app/api/admin/highlights/route"},resolvedPagePath:"/Users/macbookpro/Personal Work/tecverse03/app/api/admin/highlights/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:g}=h,m="/api/admin/highlights/route";function f(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},3360:(e,r,t)=>{t.d(r,{ag:()=>l,pR:()=>n,v9:()=>u});var s=t(43974),i=t(42023);let o=process.env.SUPABASE_SERVICE_ROLE_KEY,n=(0,s.eI)("https://xplcgqfweqzliiwchmqw.supabase.co",o);async function a(e,r){return i.compare(e,r)}async function u(e,r){try{let{data:t,error:s}=await n.from("admin_users").select("*").eq("email",e).eq("is_active",!0).single();if(s||!t||!await a(r,t.password_hash))return null;await n.from("admin_users").update({last_login:new Date().toISOString()}).eq("id",t.id);let{password_hash:i,...o}=t;return o}catch(e){return console.error("Authentication error:",e),null}}async function l(e,r,t,s=null,i=null,o=null){try{await n.from("activity_logs").insert({admin_id:e,action:r,table_name:t,record_id:s,old_values:i,new_values:o})}catch(e){console.error("Activity log error:",e)}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972,3974,2023],()=>t(82432));module.exports=s})();